# Deploying to Render.com

## Prerequisites
- GitHub account with this repository pushed
- Supabase project set up (see SETUP.md)
- OAuth credentials from Google/Facebook/Microsoft (optional)

## Deployment Steps

### 1. Push to GitHub
```bash
git add .
git commit -m "Prepare for Render deployment"
git push origin main
```

### 2. Create Render Account
- Go to https://render.com
- Sign up or log in with GitHub

### 3. Create New Web Service
1. Click "New +" → "Web Service"
2. Connect your GitHub repository
3. Select `diving-competition-app` repository
4. Render will auto-detect settings from `render.yaml`

### 4. Configure Environment Variables
In Render dashboard, set these environment variables:

**Required:**
- `SUPABASE_URL` - Your Supabase project URL
- `SUPABASE_ANON_KEY` - Your Supabase anon/public key
- `SESSION_SECRET` - Auto-generated by Render

**Optional (for OAuth login):**
- `GOOGLE_CLIENT_ID`
- `GOOGLE_CLIENT_SECRET`
- `FACEBOOK_APP_ID`
- `FACEBOOK_APP_SECRET`
- `MICROSOFT_CLIENT_ID`
- `MICROSOFT_CLIENT_SECRET`

### 5. Update OAuth Callback URLs
Once deployed, update your OAuth provider callback URLs:

**Google Cloud Console:**
- Authorized redirect URI: `https://your-app-name.onrender.com/auth/google/callback`

**Facebook Developer:**
- Valid OAuth Redirect URI: `https://your-app-name.onrender.com/auth/facebook/callback`

**Microsoft Azure:**
- Redirect URI: `https://your-app-name.onrender.com/auth/microsoft/callback`

### 6. Deploy
- Click "Create Web Service"
- Render will build and deploy automatically
- First deploy takes ~5 minutes

## After Deployment

### Access Your App
Your app will be available at: `https://your-app-name.onrender.com`

### Monitor Logs
- View real-time logs in Render dashboard
- Check for any startup errors

### Update Supabase RLS Policies (Optional)
If you enabled RLS policies, update them to allow access from your Render domain.

## Important Notes

### Free Tier Limitations
- App spins down after 15 minutes of inactivity
- First request after spin-down takes ~30 seconds
- Upgrade to paid plan for always-on service

### Session Persistence
- Current setup uses in-memory sessions
- Sessions are lost on server restart/redeploy
- For production, consider implementing Supabase-based session store

### Database
- Uses Supabase (PostgreSQL) - already cloud-hosted
- No additional database setup needed on Render

## Troubleshooting

### Build Fails
- Check `package.json` has all dependencies
- Verify Node.js version compatibility

### App Crashes on Start
- Check environment variables are set correctly
- View logs in Render dashboard
- Verify Supabase credentials are valid

### OAuth Not Working
- Verify callback URLs match exactly (including https://)
- Check OAuth credentials are set in environment variables
- Ensure OAuth apps are configured for production use

## Custom Domain (Optional)
1. Go to Settings → Custom Domain
2. Add your domain
3. Update DNS records as instructed
4. Update OAuth callback URLs to use custom domain

## Automatic Deployments
- Render automatically deploys when you push to `main` branch
- Disable in Settings if you prefer manual deployments
